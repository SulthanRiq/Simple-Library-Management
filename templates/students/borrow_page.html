{% extends "layout.html" %}

{% block title %}
    Borrow
{% endblock %}

{% block main %}

    {% if error %}
        <div class="container">
            <div class="mx-auto alert alert-danger">
                {{ error }}
            </div>
        </div>
    {% endif %}

    <form action="/borrow" method="post" enctype="multipart/form-data">
        <div class="form-group mb-3 pt-4">
            <input autocomplete="off" autofocus class="form-control mx-auto w-auto" name="book_title" placeholder="Book Title" type="text" maxlength="25" required>
        </div>
        <div class="form-group mb-3">
            <input autocomplete="off" class="form-control mx-auto w-auto" name="book_writer" placeholder="Book Writer" type="text" maxlength="15" required>
        </div>
        <div class="form-group mb-3">
            <input autocomplete="off" class="form-control mx-auto w-auto" name="publication_year" placeholder="Publication Year" type="text" pattern="\d*" maxlength="4" inputmode="numeric" required>
        </div>
        <div class="mb-3 text-center">
            <label for="borrowDate">Borrow Date</label>
            <input autocomplete="off" class="form-control mx-auto w-auto" id="b_date" name="borrow_date" type="date" required>
        </div>
        <div class="mb-3 text-center">
            <label for="returnDate" class="">Return Date</label>
            <input autocomplete="off" class="form-control mx-auto w-auto" id="r_date" name="return_date" placeholder="Return Date" type="date" required>
        </div>
        <h5 class="mb-3 text-center">Book Image</h5>
        <div class="mb-3 text-center">
            <label for="bookImage" class="">Select Image</label>
            <input type="file" name="book_image" accept=".jpg, .jpeg, .png" required>
        </div>
        <div class="mb-3 text-center">
            <small>Format: JPG, JPEG, PNG</small>
        </div>
        <div class="col text-center">
            <button class="btn btn-primary" type="submit">Submit</button>
        </div>
    </form>
{% endblock %}

<script>
    function validateDates() {
        const borrow = new Date(document.getElementById('b_date').value);
        const ret = new Date(document.getElementById('r_date').value);

        if (ret < borrow) {
            alert("Return date must be before the borrow date!");
            return false;
        }
        
        return true;
    }

    document.querySelector('input[name="book_image"]').addEventListener('change', function() {
        const file = this.files[0];
        if (file && file.size > 2 * 1024 * 1024) {
            alert("Invalid file size. Max 2 MB!");
            this.value = "";
        }
    })
</script>